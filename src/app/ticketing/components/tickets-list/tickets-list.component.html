<div class="w-full overflow-x-auto mt-20 bg-white rounded-xl">
  <!--  -->
  <div class="flex items-center justify-between p-4">
    <button
      hlmBtn
      variant="outline"
      class="gap-2 pointer-events-none border-none text-oryo-green"
      size="sm"
    >
      <span>All tickets ({{ _tickets().length }})</span>
    </button>

    <div class="relative">
      <hlm-icon
        size="sm"
        class="absolute top-1/2 -translate-y-1/2 left-2.5 text-muted-foreground"
        name="lucideSearch"
      />
      <input
        hlmInput
        class="w-96 pl-8 bg-muted"
        placeholder="Search for clients,ticket id, staff..."
        type="Search"
      />
    </div>

    <div class="flex items-center gap-2.5">
      <button hlmBtn variant="outline" class="gap-2" size="sm">
        <hlm-icon class="size-3.5" name="lucideFilter" />
        <span>Filter</span>
      </button>
      <brn-popover sideOffset="5" closeDelay="100">
        <button
          hlmBtn
          variant="outline"
          class="gap-2"
          size="sm"
          brnPopoverTrigger
        >
          <hlm-icon class="size-3.5" name="lucideChevronsUpDown" />
          <span>Sort</span>
        </button>
        <div
          hlmPopoverContent
          class="w-80 grid gap-4"
          *brnPopoverContent="let ctx"
        >
          <div class="space-y-2">
            <h4 class="font-medium leading-none">Sort by</h4>
            <p class="text-sm text-muted-foreground">
              Kindly select what you want to filter
            </p>
          </div>
          <div class="grid gap-2">
            <small hlmSmall class="font-semibold">Priority</small>
            <brn-radio-group
              class="mb-4 font-mono text-sm font-medium space-y-1"
              hlm
            >
              <brn-radio hlm value="URGENT">
                <hlm-radio-indicator indicator />
                Urgent
              </brn-radio>
              <brn-radio hlm value="HIGH">
                <hlm-radio-indicator indicator />
                High
              </brn-radio>
              <brn-radio hlm value="MEDIUM">
                <hlm-radio-indicator indicator />
                Medium
              </brn-radio>
              <brn-radio hlm value="LOW">
                <hlm-radio-indicator indicator />
                Low
              </brn-radio>
            </brn-radio-group>
          </div>
          <div class="flex gap-2">
            <button hlmBtn variant="outline" class="gap-2 w-full">
              Cancel
            </button>
            <button hlmBtn class="gap-2 w-full">Sort</button>
          </div>
        </div>
      </brn-popover>

      <hlm-dialog>
        <button hlmBtn brnDialogTrigger class="gap-2" size="sm">
          <hlm-icon class="size-3.5" name="lucidePlus" />
          <span>Create ticket</span>
        </button>
        <hlm-dialog-content
          class="w-screen max-w-2xl"
          *brnDialogContent="let ctx"
        >
          <hlm-dialog-header>
            <h3 hlmDialogTitle>Create Ticket</h3>
          </hlm-dialog-header>

          <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
            <div class="space-y-2">
              <label hlmLabel for="name">
                <span>Reporter's name</span>
              </label>
              <input class="w-full" hlmInput id="name" formControlName="name" />
            </div>

            <div class="space-y-2">
              <label hlmLabel for="email">
                <span>Email</span>
              </label>
              <input
                class="w-full"
                hlmInput
                id="email"
                type="email"
                formControlName="email"
              />
            </div>
            <div class="space-y-2">
              <label hlmLabel for="phone">
                <span>Phone number</span>
              </label>
              <input
                class="w-full"
                hlmInput
                id="phone"
                formControlName="phone"
              />
            </div>

            <div class="space-y-2">
              <label hlmLabel for="company">
                <span>Company name</span>
              </label>
              <input
                class="w-full"
                hlmInput
                id="company"
                formControlName="company"
              />
            </div>
            <div class="space-y-2">
              <label hlmLabel for="issue-type">Support task issue</label>
              <brn-radio-group
                class="mb-4 font-mono text-sm font-medium space-y-1"
                formControlName="issueType"
                hlm
              >
                <brn-radio hlm value="Missing fuel logs">
                  <hlm-radio-indicator indicator />
                  Fuel logs
                </brn-radio>
                <brn-radio hlm value="Missing truck locations">
                  <hlm-radio-indicator indicator />
                  Truck locations
                </brn-radio>
                <brn-radio hlm value="Missing records">
                  <hlm-radio-indicator indicator />
                  Tank records
                </brn-radio>
                <brn-radio hlm value="AI cameras">
                  <hlm-radio-indicator indicator />
                  AI cameras
                </brn-radio>
                <brn-radio hlm value="GPS tracking">
                  <hlm-radio-indicator indicator />
                  GPS tracking
                </brn-radio>
              </brn-radio-group>
            </div>
            <div class="space-y-2">
              <label hlmLabel for="description">Description</label>
              <textarea
                hlmInput
                formControlName="description"
                id="description"
                class="min-h-32 w-full"
                placeholder="Describe the issue you're facing"
              ></textarea>
            </div>
            <div class="col-span-2 lg:col-span-2 space-y-2">
              <label hlmLabel for="ticketId">
                <span>Ticket ID</span>
              </label>
              <input
                class="w-full bg-muted pointer-events-none"
                id="ticketId"
                formControlName="ticketId"
                hlmInput
                readonly
              />
            </div>

            <div class="space-y-2">
              <label hlmLabel for="status"> Status </label>
              <brn-select
                class="block"
                formControlName="status"
                placeholder="Select an option"
              >
                <hlm-select-trigger class="w-full">
                  <hlm-select-value />
                </hlm-select-trigger>
                <hlm-select-content>
                  <hlm-option value="open"> Open </hlm-option>
                  <hlm-option value="in-progress"> In Progress </hlm-option>
                  <hlm-option value="close"> Close </hlm-option>
                </hlm-select-content>
              </brn-select>
            </div>

            <div class="space-y-2">
              <label hlmLabel for="priority"> Priority </label>
              <brn-select
                class="block"
                formControlName="priority"
                placeholder="Select an option"
              >
                <hlm-select-trigger class="w-full">
                  <hlm-select-value />
                </hlm-select-trigger>
                <hlm-select-content>
                  <hlm-option value="high"> High </hlm-option>
                  <hlm-option value="medium"> Medium </hlm-option>
                  <hlm-option value="low"> Low </hlm-option>
                </hlm-select-content>
              </brn-select>
            </div>
          </div>

          <hlm-dialog-footer>
            <button hlmBtn type="submit" class="w-full">Create</button>
          </hlm-dialog-footer>
        </hlm-dialog-content>
      </hlm-dialog>
    </div>
  </div>

  <hlm-table class="w-full min-w-[500px]">
    <!-- <hlm-caption>A list of your recent tickets.</hlm-caption> -->
    <hlm-trow class="uppercase">
      <hlm-th class="w-fit">
        <hlm-checkbox />
      </hlm-th>
      <hlm-th class="w-52">Ticket ID</hlm-th>
      <hlm-th class="w-60">Customer</hlm-th>
      <hlm-th class="max-w-56 w-full">Subject</hlm-th>
      <hlm-th class="flex-1">Priority</hlm-th>
      <hlm-th class="flex-1">Status</hlm-th>
      <hlm-th class="justify-start w-40">Actions</hlm-th>
    </hlm-trow>
    @for (ticket of _tickets(); track ticket.id) {
    <hlm-trow>
      <hlm-td truncate class="font-medium w-fit">
        <hlm-checkbox />
      </hlm-td>
      <hlm-td truncate class="font-medium w-52">
        <p class="text-foreground font-medium">{{ ticket.ticketId }}</p>
        <p class="text-muted-foreground lowercase">
          {{ ticket.dateCreated | date : "dd/MM/yyyy h:mma" }}
        </p>
      </hlm-td>
      <hlm-td class="w-60 flex flex-col items-start">
        <p class="text-foreground font-medium">{{ ticket.customerName }}</p>
        <p class="text-muted-foreground">{{ ticket.companyName }}</p>
      </hlm-td>
      <hlm-td class="max-w-56 w-full">
        <span class="truncate">{{ ticket.subject }}</span>
      </hlm-td>
      <hlm-td class="flex-1">
        <p
          class="text-sm uppercase tracking-tighter"
          [ngClass]="{
            'text-yellow-500': ticket.priority === 'HIGH',
            'text-blue-500': ticket.priority === 'LOW',
            'text-black': ticket.priority === 'MEDIUM',
            'text-red-500': ticket.priority === 'URGENT',
          }"
        >
          {{ ticket.priority | ticketPriorityDisplay }}
        </p>
        <!-- <div hlmBadge [variant]="getPriorityVariant(ticket.priority)">
          {{ ticket.priority | ticketPriorityDisplay }}
        </div> -->
      </hlm-td>
      <hlm-td class="flex-1">
        <div hlmBadge [variant]="getStatusVariant(ticket.status)">
          {{ ticket.status | ticketStatusDisplay }}
        </div>
      </hlm-td>
      <hlm-td class="justify-start w-40">
        <button
          hlmBtn
          variant="ghost"
          class="size-6 p-0.5"
          align="center"
          [brnMenuTriggerFor]="menu"
        >
          <hlm-icon class="size-4" name="lucideMoreHorizontal" />
        </button>
        <ng-template #menu>
          <hlm-menu>
            <hlm-menu-label>Actions</hlm-menu-label>
            <hlm-menu-separator />
            <hlm-menu-group>
              <button hlmMenuItem>View ticket</button>
              <button hlmMenuItem>Edit ticket</button>
            </hlm-menu-group>
            <hlm-menu-separator />
            <hlm-menu-group>
              <button
                hlmMenuItem
                class="text-destructive hover:text-destructive"
              >
                Delete ticket
              </button>
            </hlm-menu-group>
          </hlm-menu>
        </ng-template>
      </hlm-td>
    </hlm-trow>
    } @empty {
    <hlm-caption>No tickets found</hlm-caption>
    }
  </hlm-table>
</div>
